<VirtualHost <%= svn_ip_address %>:<%= svn_ssl? ? '443' : '80' %>>

  <% if svn_ssl? %>
  SSLEngine on
  SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
  SSLCertificateFile    <%= configuration[:redmine][:repository_management][:certificate_file] || configuration[:ssl][:certificate_file] || '/etc/ssl/certs/ssl-cert-snakeoil.pem' %>
  SSLCertificateKeyFile <%= configuration[:redmine][:repository_management][:certificate_key_file] || configuration[:ssl][:certificate_key_file] || '/etc/ssl/private/ssl-cert-snakeoil.key' %>
  <% if configuration[:redmine][:repository_management][:certificate_chain_file] || configuration[:ssl][:certificate_chain_file] %>
  SSLCertificateChainFile <%= configuration[:redmine][:repository_management][:certificate_chain_file] || configuration[:ssl][:certificate_chain_file] %>
  <% else %>
  # SSLCertificateChainFile /etc/apache2/ssl.crt/server-ca.crt
  <% end %>
  <% end %>

  ServerName <%= svn_host %>

  DocumentRoot /srv/<%= svn_host %>
  <Directory /srv/<%= svn_host %>>
    Options FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
    <% if svn_ssl? %>
    SSLRequireSSL
    <% end %>
  </Directory>

  RailsAutoDetect off

  Include /etc/apache2/svn-hosting.conf

</VirtualHost>

